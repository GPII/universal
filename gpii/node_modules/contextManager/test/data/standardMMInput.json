{
    "preferences": {
        "contexts": {
            "gpii-default": {
                "name": "Default preferences",
                "preferences": {
                    "http://registry.gpii.net/common/fontSize": 15,
                    "http://registry.gpii.net/common/speechRate": 15
                }
            },
            "nighttime-at-home": {
                "name": "Nighttime at home",
                "preferences": {
                    "http://registry.gpii.net/common/fontSize": 18
                },
                "metadata": [
                   {
                        "type": "required",
                        "scope": ["http://registry.gpii.net/common/fontSize"],
                        "value": 100
                    }
                ],
                "conditions": [
                    {
                        "type": "http://gpii.net/common/operators/inRange",
                        "max": 1800,
                        "min": 600,
                        "inputPath": "http://registry.gpii.net/conditions/timeOfDay"
                    }
                ]
            }
        }
    },
    "deviceReporter": {
        "OS": {
            "id": "win32",
            "version": "5.0.0"
        },
        "solutions": [
            {
                "id": "com.microsoft.windows.onscreenKeyboard"
            }, {
                "id": "com.microsoft.windows.mouseTrailing"
            }, {
                "id": "org.nvda-project"
            }, {
                "id": "com.freedomScientific.jaws"
            }
        ]
    },
    "environmentReporter": {
        "http://registry.gpii.net/terms/environment/brightness": 60,
        "http://registry.gpii.net/terms/environment/sound": -6,
        "http://registry.gpii.net/terms/environment/timeOfDay": "18:29:00",
        "http://registry.gpii.net/terms/environment/location": {
            "lat": "43.999N",
            "long": "74.382W"
        }
    },
    "solutionsRegistry": {
        "com.freedomscientific.jaws": {
            "name": "JAWS",
            "contexts": {
                "OS": [
                    {
                        "id": "win32"
                    }
                ]
            },
            "settingsHandlers": [
                {
                    "type": "gpii.settingsHandlers.INISettingsHandler.set",
                    "options": {
                        "path": "${{environment}.APPDATA}\\Freedom Scientific\\JAWS\\15.0\\Settings\\VoiceProfiles.ini"
                    },
                    "capabilities": [
                        "applications.com\\.freedomscientific\\.jaws.id"
                    ],
                    "capabilitiesTransformations": {
                        "cloud4allVoiceProfile-GlobalContext\\.Punctuation": {
                            "transform": {
                                "type": "fluid.transforms.valueMapper",
                                "inputPath": "http://registry\\.gpii\\.net/common/punctuationVerbosity",
                                "options": {
                                    "none": {
                                        "outputValue": 0
                                    },
                                    "some": {
                                        "outputValue": 1
                                    },
                                    "most": {
                                        "outputValue": 2
                                    },
                                    "all": {
                                        "outputValue": 3
                                    }
                                }
                            }
                        },
                        "cloud4allVoiceProfile-GlobalContext\\.Speed": {
                            "transform": {
                                "type": "fluid.transforms.linearScale",
                                "valuePath": "http://registry\\.gpii\\.net/common/speechRate",
                                "factor": 0.125,
                                "offset": -12.125
                            }
                        }
                    }
                }
            ],
            "lifecycleManager": {
                "start": [
                    "setSettings",
                    {
                        "type": "gpii.launch.exec",
                        "command": "\"${{registry}.HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\App Paths\\JAWS15.exe\\}\""
                    }
                ],
                "stop": [
                    {
                        "type": "gpii.launch.exec",
                        "command": "${{environment}.SystemRoot}\\System32\\taskkill.exe /f /im jfw.exe"
                    },
                    "restoreSettings"
                ]
            }
        },
        "com.microsoft.windows.onscreenKeyboard": {
            "name": "Windows Built-in Onscreen Keyboard",
            "contexts": {
                "OS": [
                    {
                        "id": "win32",
                        "version": ">=5.0"
                    }
                ]
            },
            "settingsHandlers": [
                {
                    "type": "gpii.settingsHandlers.noSettings",
                    "capabilities": [
                        "control.onscreenKeyboard",
                        "applications.com\\.microsoft\\.windows\\.onscreenKeyboard.id",
                        "control.onscreenKeyboard.applications.com\\.microsoft\\.windows\\.onscreenKeyboard.name"
                    ]
                }
            ],
            "lifecycleManager": {
                "start": [
                    {
                        "type": "gpii.launch.exec",
                        "command": "${{environment}.SystemRoot}\\System32\\osk.exe"
                    }
                ],
                "stop": [
                    {
                        "type": "gpii.launch.exec",
                        "command": "${{environment}.SystemRoot}\\System32\\taskkill.exe /im osk.exe"
                    }
                ]
            }
        },

        "org.nvda-project": {
            "name": "NVDA Screen Reader",
            "contexts": {
                "OS": [
                    {
                        "id": "win32",
                        "version": ">=5.0"
                    }
                ]
            },
            "settingsHandlers": [
                {
                    "type": "gpii.settingsHandlers.INISettingsHandler.set",
                    "options": {
                        "path": "${{environment}.APPDATA}\\nvda\\nvda.ini",
                        "allowNumberSignComments": true,
                        "allowSubSections": true
                    },
                    "capabilities": [
                        "applications.org\\.nvda-project.id",
                        "display.screenReader.applications.org\\.nvda-project.name"
                    ],
                    "capabilitiesTransformations": {
                        "speech\\.espeak\\.pitch": {
                            "transform": {
                                "type": "fluid.transforms.linearScale",
                                "valuePath": "http://registry\\.gpii\\.net/common/pitch",
                                "factor": 100
                            }
                        },
                        "speech\\.espeak\\.volume": {
                            "transform": {
                                "type": "fluid.transforms.linearScale",
                                "inputPath": "http://registry\\.gpii\\.net/common/volumeTTS",
                                "factor": 100
                            }
                        },
                        "presentation\\.reportHelpBalloons": "http://registry\\.gpii\\.net/common/speakTutorialMessages",
                        "keyboard\\.speakTypedCharacters": "http://registry\\.gpii\\.net/common/keyEcho",
                        "keyboard\\.speakTypedWords": "http://registry\\.gpii\\.net/common/wordEcho",
                        "speech\\.espeak\\.sayCapForCapitals": "http://registry\\.gpii\\.net/common/announceCapitals",
                        "virtualBuffers\\.autoSayAllOnPageLoad": {
                            "transform": {
                                "type": "fluid.transforms.valueMapper",
                                "inputPath": "http://registry\\.gpii\\.net/common/readingUnit",
                                "defaultInputValue": "sentence",
                                "options": {
                                    "all": {
                                        "outputValue": true
                                    },
                                    "sentence": {
                                        "outputValue": false
                                    }
                                }
                            }
                        },
                        "transform": [
                            {
                                "type": "fluid.transforms.arrayToSetMembership",
                                "inputPath": "http://registry\\.gpii\\.net/common/trackingTTS",
                                "presentValue": true,
                                "missingValue": false,
                                "options": {
                                    "focus": "reviewCursor\\.followFocus",
                                    "caret": "reviewCursor\\.followCaret",
                                    "mouse": "reviewCursor\\.followMouse"
                                }
                            },
                            {
                                "type": "fluid.transforms.valueMapper",
                                "inputPath": "http://registry\\.gpii\\.net/common/screenReaderTTSEnabled",
                                "options": {
                                    "false": {
                                        "outputValue": {
                                            "transform": [
                                                {
                                                    "type": "fluid.transforms.literalValue",
                                                    "value": "silence",
                                                    "outputPath": "speech\\.synth"
                                                },
                                                {
                                                    "type": "fluid.transforms.literalValue",
                                                    "value": "Microsoft Sound Mapper",
                                                    "outputPath": "speech\\.outputDevice"
                                                }
                                            ]
                                        }
                                    }
                                }
                            }
                        ],
                        "speech\\.espeak\\.rate": {
                            "transform": {
                                "type": "fluid.transforms.binaryOp",
                                "right": 3.10,
                                "operator": "/",
                                "left": {
                                    "transform": {
                                        "type": "fluid.transforms.binaryOp",
                                        "right": 80,
                                        "operator": "-",
                                        "left": {
                                            "transform": {
                                                "type": "fluid.transforms.condition",
                                                "truePath": "http://registry\\.gpii\\.net/common/speechRate",
                                                "false": {
                                                    "transform": {
                                                        "type": "fluid.transforms.binaryOp",
                                                        "leftPath": "http://registry\\.gpii\\.net/common/speechRate",
                                                        "operator": "/",
                                                        "right": 3
                                                    }
                                                },
                                                "condition": {
                                                    "transform": {
                                                        "type": "fluid.transforms.binaryOp",
                                                        "leftPath": "http://registry\\.gpii\\.net/common/speechRate",
                                                        "operator": "<=",
                                                        "right": 390
                                                    }
                                                }
                                            }
                                        }
                                    }
                                }
                            }
                        },
                        "speech\\.espeak\\.rateBoost": {
                            "transform": {
                                "type": "fluid.transforms.binaryOp",
                                "leftPath": "http://registry\\.gpii\\.net/common/speechRate",
                                "operator": ">",
                                "right": 390
                            }
                        },
                        "speech\\.symbolLevel": {
                            "transform": {
                                "type": "fluid.transforms.valueMapper",
                                "inputPath": "http://registry\\.gpii\\.net/common/punctuationVerbosity",
                                "options": {
                                    "none": {
                                        "outputValue": "0"
                                    },
                                    "some": {
                                        "outputValue": "100"
                                    },
                                    "most": {
                                        "outputValue": "200"
                                    },
                                    "all": {
                                        "outputValue": "300"
                                    }
                                }
                            }
                        },
                        "speech\\.espeak\\.voice": {
                            "transform": {
                                "type": "fluid.transforms.valueMapper",
                                "inputPath": "http://registry\\.gpii\\.net/common/auditoryOutLanguage",
                                "options": {
                                    "en": {
                                        "outputValue": "en\\en"
                                    },
                                    "en-GB": {
                                        "outputValue": "en\\en"
                                    },
                                    "en-US": {
                                        "outputValue": "en\\en-us"
                                    },
                                    "es": {
                                        "outputValue": "es"
                                    },
                                    "es-ES": {
                                        "outputValue": "es"
                                    }
                                }
                            }
                        }
                    }
                }
            ],
            "lifecycleManager": {
                "start": [
                    "setSettings",
                    {
                        "type": "gpii.launch.exec",
                        "command": "\"${{registry}.HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\App Paths\\nvda.exe\\}\""
                    }
                ],
                "stop": [
                    {
                        "type": "gpii.launch.exec",
                        "command": "${{environment}.SystemRoot}\\System32\\taskkill.exe /f /im nvda_service.exe"
                    },{
                        "type": "gpii.launch.exec",
                        "command": "${{environment}.SystemRoot}\\System32\\taskkill.exe /f /im nvda.exe"
                    },
                    "restoreSettings"
                ]
            }
        },
        "com.microsoft.windows.mouseTrailing": {
            "name": "Windows Mouse Trailing",
            "contexts": {
                "OS": [
                    {
                        "id": "win32",
                        "version": ">=5.0"
                    }
                ]
            },
            "settingsHandlers": [
                {
                    "type": "gpii.windows.spiSettingsHandler.set",
                    "options": {
                        "getAction": "SPI_GETMOUSETRAILS",
                        "setAction": "SPI_SETMOUSETRAILS",
                        "uiParam": 0,
                        "pvParam": {
                            "type": "BOOL"
                        }
                    },
                    "capabilities": [
                        "display.screenEnhancement.mouseTrailing",
                        "applications.com\\.microsoft\\.windows\\.mouseTrailing.id"
                    ],
                    "capabilitiesTransformations": {
                        "MouseTrails": {
                            "transform": {
                                "type": "fluid.transforms.value",
                                "inputPath": "http://registry\\.gpii\\.net/common/mouseTrailing",
                                "outputPath": "value"
                            },
                            "path": {
                                "transform": {
                                    "type": "fluid.transforms.literalValue",
                                    "value": {
                                        "get": "pvParam",
                                        "set": "uiParam"
                                    }
                                }
                            }
                        }
                    }
                }
            ],
            "lifecycleManager": {
                "start": [
                    "setSettings"
                ],
                "stop": [
                    "restoreSettings"
                ]
            }
        }
    },
    "activeContexts": [
        "gpii-default",
        "nighttime-at-home"
    ],
    "inverseCapabilities": {
        "com.microsoft.windows.cursors": {
            "http://registry.gpii.net/common/cursorSize": 0.60
        },
        "org.nvda-project": {
            "http://registry.gpii.net/common/speechRate": 200,
            "http://registry.gpii.net/common/keyEcho": true
        }
    }
}