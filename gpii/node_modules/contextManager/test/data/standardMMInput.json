{
    "preferences": {
        "contexts": {
            "gpii-default": {
                "name": "Default preferences",
                "preferences": {
                    "http://registry.gpii.net/common/fontSize": 15,
                    "http://registry.gpii.net/common/speechRate": 15
                }
            },
            "nighttime-at-home": {
                "name": "Nighttime at home",
                "preferences": {
                    "http://registry.gpii.net/common/fontSize": 18
                },
                "metadata": [
                   {
                        "type": "required",
                        "scope": ["http://registry.gpii.net/common/fontSize"],
                        "value": 100
                    }
                ],
                "conditions": [
                    {
                        "type": "http://registry.gpii.net/conditions/inRange",
                        "max": 1800,
                        "min": 600,
                        "inputPath": "http://registry\\.gpii\\.net/environment/illuminance"
                    }
                ]
            }
        }
    },
    "deviceContext": {
        "OS": {
            "id": "win32",
            "version": "5.0.0"
        },
        "solutions": [
            {
                "id": "com.microsoft.windows.onscreenKeyboard"
            }, {
                "id": "com.microsoft.windows.mouseTrailing"
            }, {
                "id": "org.nvda-project"
            }, {
                "id": "com.freedomScientific.jaws"
            }
        ]
    },
    "environmentReporter": {
        "http://registry.gpii.net/terms/environment/brightness": 60,
        "http://registry.gpii.net/terms/environment/sound": -6,
        "http://registry.gpii.net/terms/environment/timeOfDay": "18:29:00",
        "http://registry.gpii.net/terms/environment/location": {
            "lat": "43.999N",
            "long": "74.382W"
        }
    },
    "solutionsRegistryEntries": {
        "com.freedomscientific.jaws": {
            "name": "JAWS",
            "contexts": {
                "OS": [
                    {
                        "id": "win32"
                    }
                ]
            },
            "settingsHandlers": {
                "configuration": {
                    "type": "gpii.settingsHandlers.INISettingsHandler",
                    "options": {
                        "filename": "${{environment}.APPDATA}\\Freedom Scientific\\JAWS\\15.0\\Settings\\VoiceProfiles.ini"
                    },
                    "capabilities": [],
                    "capabilitiesTransformations": {
                        "cloud4allVoiceProfile-GlobalContext\\.Punctuation": {
                            "transform": {
                                "type": "fluid.transforms.valueMapper",
                                "defaultInputPath": "http://registry\\.gpii\\.net/common/punctuationVerbosity",
                                "match": {
                                    "none": 0,
                                    "some": 1,
                                    "most": 2,
                                    "all": 3
                                }
                            }
                        },
                        "cloud4allVoiceProfile-GlobalContext\\.Speed": {
                            "transform": {
                                "type": "fluid.transforms.linearScale",
                                "inputPath": "http://registry\\.gpii\\.net/common/speechRate",
                                "factor": 0.125,
                                "offset": -12.125
                            }
                        }
                    }
                }
            },
            "configure": [
                "settings.configuration"
            ],
            "restore": [
                "settings.configuration"
            ],
            "start": [
                {
                    "type": "gpii.launch.exec",
                    "command": "\"${{registry}.HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\App Paths\\JAWS15.exe\\}\""
                }
            ],
            "stop": [
                {
                    "type": "gpii.windows.closeProcessByName",
                    "filename": "jfw.exe"
                }
            ]
        },
        "com.microsoft.windows.onscreenKeyboard": {
            "name": "Windows Built-in Onscreen Keyboard",
            "contexts": {
                "OS": [
                    {
                        "id": "win32",
                        "version": ">=5.0"
                    }
                ]
            },
            "settingsHandlers": {
                "configure": {
                    "type": "gpii.settingsHandlers.noSettings",
                    "capabilities": [
                        "http://registry\\.gpii\\.net/common/onScreenKeyboardEnabled"
                    ]
                }
            },
            "start": [
                {
                    "type": "gpii.launch.exec",
                    "command": "${{environment}.SystemRoot}\\explorer.exe ${{environment}.SystemRoot}\\System32\\osk.exe"
                }
            ],
            "stop": [
                {
                    "type": "gpii.windows.closeProcessByName",
                    "filename": "osk.exe"
                }
            ]
        },

        "org.nvda-project": {
            "name": "NVDA Screen Reader",
            "contexts": {
                "OS": [
                    {
                        "id": "win32",
                        "version": ">=5.0"
                    }
                ]
            },
            "settingsHandlers": {
                "configs": {
                    "type": "gpii.settingsHandlers.INISettingsHandler",
                    "options": {
                        "filename": "${{environment}.APPDATA}\\nvda\\nvda.ini",
                        "allowNumberSignComments": true,
                        "allowSubSections": true
                    },
                    "capabilities": [],
                    "capabilitiesTransformations": {
                        "speech\\.espeak\\.pitch": {
                            "transform": {
                                "type": "fluid.transforms.linearScale",
                                "inputPath": "http://registry\\.gpii\\.net/common/pitch",
                                "factor": 100
                            }
                        },
                        "speech\\.espeak\\.volume": {
                            "transform": {
                                "type": "fluid.transforms.linearScale",
                                "inputPath": "http://registry\\.gpii\\.net/common/volumeTTS",
                                "factor": 100
                            }
                        },
                        "presentation\\.reportHelpBalloons": "http://registry\\.gpii\\.net/common/speakTutorialMessages",
                        "keyboard\\.speakTypedCharacters": "http://registry\\.gpii\\.net/common/keyEcho",
                        "keyboard\\.speakTypedWords": "http://registry\\.gpii\\.net/common/wordEcho",
                        "speech\\.espeak\\.sayCapForCapitals": "http://registry\\.gpii\\.net/common/announceCapitals",
                        "transform": [
                            {
                                "type": "fluid.transforms.arrayToSetMembership",
                                "inputPath": "http://registry\\.gpii\\.net/common/trackingTTS",
                                "presentValue": true,
                                "missingValue": false,
                                "options": {
                                    "focus": "reviewCursor\\.followFocus",
                                    "caret": "reviewCursor\\.followCaret",
                                    "mouse": "reviewCursor\\.followMouse"
                                }
                            },
                            {
                                "type": "fluid.transforms.valueMapper",
                                "defaultInputPath": "http://registry\\.gpii\\.net/common/screenReaderTTSEnabled",
                                "match": {
                                    "false": {
                                        "outputValue": {
                                            "transform": [
                                                {
                                                    "type": "fluid.transforms.literalValue",
                                                    "input": "silence",
                                                    "outputPath": "speech\\.synth"
                                                },
                                                {
                                                    "type": "fluid.transforms.literalValue",
                                                    "input": "Microsoft Sound Mapper",
                                                    "outputPath": "speech\\.outputDevice"
                                                }
                                            ]
                                        }
                                    }
                                }
                            }
                        ],
                        "speech\\.espeak\\.rate": {
                            "transform": {
                                "type": "fluid.transforms.round",
                                "input": {
                                    "transform": {
                                        "type": "fluid.transforms.binaryOp",
                                        "right": 3.10,
                                        "operator": "/",
                                        "left": {
                                            "transform": {
                                                "type": "fluid.transforms.binaryOp",
                                                "right": 80,
                                                "operator": "-",
                                                "left": {
                                                    "transform": {
                                                        "type": "fluid.transforms.condition",
                                                        "truePath": "http://registry\\.gpii\\.net/common/speechRate",
                                                        "false": {
                                                            "transform": {
                                                                "type": "fluid.transforms.binaryOp",
                                                                "leftPath": "http://registry\\.gpii\\.net/common/speechRate",
                                                                "operator": "/",
                                                                "right": 3
                                                            }
                                                        },
                                                        "condition": {
                                                            "transform": {
                                                                "type": "fluid.transforms.binaryOp",
                                                                "leftPath": "http://registry\\.gpii\\.net/common/speechRate",
                                                                "operator": "<=",
                                                                "right": 390
                                                            }
                                                        }
                                                    }
                                                }
                                            }
                                        }
                                    }
                                }
                            }
                        },
                        "speech\\.espeak\\.rateBoost": {
                            "transform": {
                                "type": "fluid.transforms.binaryOp",
                                "leftPath": "http://registry\\.gpii\\.net/common/speechRate",
                                "operator": ">",
                                "right": 390
                            }
                        },
                        "speech\\.symbolLevel": {
                            "transform": {
                                "type": "fluid.transforms.valueMapper",
                                "defaultInputPath": "http://registry\\.gpii\\.net/common/punctuationVerbosity",
                                "match": {
                                    "none": 0,
                                    "some": 100,
                                    "most": 200,
                                    "all": 300
                                }
                            }
                        }
                    }
                }
            },
            "configure": [
                "settings.configs"
            ],
            "restore": [
                "settings.configs"
            ],
            "start": [
                {
                    "type": "gpii.launch.exec",
                    "command": "\"${{registry}.HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\App Paths\\nvda.exe\\}\""
                }
            ],
            "stop": [
                {
                    "type": "gpii.windows.closeProcessByName",
                    "filename": "nvda_service.exe"
                },{
                    "type": "gpii.windows.closeProcessByName",
                    "filename": "nvda.exe"
                }
            ]
        },
        "com.microsoft.windows.mouseTrailing": {
            "name": "Windows Mouse Trailing",
            "contexts": {
                "OS": [
                    {
                        "id": "win32",
                        "version": ">=5.0"
                    }
                ]
            },
            "settingsHandlers": {
                "configure": {
                    "type": "gpii.windows.spiSettingsHandler",
                    "options": {
                        "getAction": "SPI_GETMOUSETRAILS",
                        "setAction": "SPI_SETMOUSETRAILS",
                        "uiParam": 0,
                        "pvParam": {
                            "type": "UINT"
                        },
                        "verifySettings": true
                    },
                    "capabilities": [
                        "http://registry\\.gpii\\.net/common/mouseTrailing"
                    ],
                    "capabilitiesTransformations": {
                        "MouseTrails": {
                            "transform": {
                                "type": "fluid.transforms.value",
                                "inputPath": "http://registry\\.gpii\\.net/common/mouseTrailing",
                                "outputPath": "value"
                            },
                            "path": {
                                "transform": {
                                    "type": "fluid.transforms.literalValue",
                                    "input": {
                                        "get": "pvParam",
                                        "set": "uiParam"
                                    }
                                }
                            }
                        }
                    }
                }
            },
            "configure": [
                "settings.configure"
            ],
            "restore": [
                "settings.configure"
            ]
        }
    },
    "activeContexts": [
        "gpii-default",
        "nighttime-at-home"
    ],
    "inverseCapabilities": {
        "com.microsoft.windows.cursors": {
            "http://registry.gpii.net/common/cursorSize": 0.60
        },
        "org.nvda-project": {
            "http://registry.gpii.net/common/speechRate": 200,
            "http://registry.gpii.net/common/keyEcho": true
        }
    }
}