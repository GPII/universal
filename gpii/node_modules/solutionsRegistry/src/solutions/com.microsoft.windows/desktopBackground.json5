{
  "name": "Windows desktop background personalization",
  "isInstalled": [
    {
      "type": "gpii.deviceReporter.alwaysInstalled"
    }
  ],
  "parents": [
    "gpii.solutionsRegistry.solution",
    "gpii.solutionsRegistry.context.windows"
  ],
  "key": "com.microsoft.windows.desktopBackground",
  "settingsHandlers": {
    "configureWallpaperStyle": {
      "liveness": "liveRestart",
      "options": {
        "hKey": "HKEY_CURRENT_USER",
        "path": "Control Panel\\Desktop",
        "dataTypes": {
          "TileWallpaper": "REG_SZ",
          "WallpaperStyle": "REG_SZ",
          "Scaling": "REG_SZ"
        }
      },
      "capabilitiesTransformations": {
        "TileWallpaper": {
          "transform": {
            "type": "fluid.transforms.valueMapper",
            "defaultInputPath": "http://registry\\.gpii\\.net/applications/com\\.microsoft\\.windows\\.desktopBackground.Scaling",
            "match": {
              "Fill": "0",
              "Fit": "0",
              "Stretch": "0",
              "Tile": "1",
              "Center": "0",
              "Span": "0"
            },
            "noMatch": {
              "outputValue": "0"
            }
          }
        },
        "WallpaperStyle": {
          "transform": {
            "type": "fluid.transforms.valueMapper",
            "defaultInputPath": "http://registry\\.gpii\\.net/applications/com\\.microsoft\\.windows\\.desktopBackground.Scaling",
            "match": {
              "Fill": "6",
              "Fit": "10",
              "Stretch": "2",
              "Tile": "0",
              "Center": "0",
              "Span": "22"
            },
            "noMatch": {
              "outputValue": "6"
            }
          }
        }
      },
      "inverseCapabilitiesTransformations": {
        "http://registry\\.gpii\\.net/applications/com\\.microsoft\\.windows\\.desktopBackground.Scaling": {
          "transform": {
            "type": "fluid.transforms.valueMapper",
            "defaultInputPath": "WallpaperStyle",
            "match": {
              "0": {
                "outputValue": {
                  "transform": {
                    "type": "fluid.transforms.valueMapper",
                    "defaultInputPath": "TileWallpaper",
                    "match": {
                      "0": "Center",
                      "1": "Tile"
                    },
                    "noMatch": {
                      "outputValue": "Tile"
                    }
                  }
                }
              },
              "2": "Stretch",
              "6": "Fill",
              "10": "Fit",
              "22": "Span"
            },
            "noMatch": {
              "outputValue": "Fill"
            }
          }
        }
      },
      "settingsHandlerNamespace": "gpii.windows.registrySettingsHandler",
      "key": "configureWallpaperStyle",
      "supportedSettings": {
        "TileWallpaper": {
          "schema": {
            "title": "Desktop wallpaper tiling",
            "description": "Sets the wallpaper to tiling style.",
            "enum": [
              "0",
              "1"
            ],
            "enumLabels": [
              "off",
              "on"
            ]
          },
          "key": "TileWallpaper"
        },
        "WallpaperStyle": {
          "schema": {
            "title": "Desktop wallpaper style",
            "description": "Sets the wallpaper style.",
            "enum": [
              "0",
              "2",
              "6",
              "10",
              "22"
            ],
            "enumLabels": [
              "None",
              "Stretch",
              "Fill",
              "Fit",
              "Span"
            ]
          },
          "key": "WallpaperStyle"
        },
        "Scaling": {
          "schema": {
            "title": "Desktop wallpaper scaling",
            "description": "Sets the wallpaper to scaling type.",
            "enum": [
              "Fill",
              "Fit",
              "Stretch",
              "Tile",
              "Center",
              "Span"
            ],
            "enumLabels": [
              "Fill",
              "Fit",
              "Stretch",
              "Tile",
              "Center",
              "Span"
            ]
          },
          "key": "Scaling"
        }
      }
    },
    "configureImage": {
      "liveness": "live",
      "options": {
        "getAction": "SPI_GETDESKWALLPAPER",
        "setAction": "SPI_SETDESKWALLPAPER",
        "uiParam": 260,
        "pvParam": {
          "type": "array",
          "valueType": "TCHAR",
          "length": 260
        }
      },
      "capabilitiesTransformations": {
        "ImageConfig": {
          "value": "http://registry\\.gpii\\.net/applications/com\\.microsoft\\.windows\\.desktopBackground.Image",
          "path": {
            "transform": {
              "type": "fluid.transforms.literalValue",
              "input": "pvParam"
            }
          }
        }
      },
      "inverseCapabilitiesTransformations": {
        "http://registry\\.gpii\\.net/applications/com\\.microsoft\\.windows\\.desktopBackground.Image": "ImageConfig.value"
      },
      "settingsHandlerNamespace": "gpii.windows.spiSettingsHandler",
      "key": "configureImage",
      "supportedSettings": {
        "ImageConfig": {
          "schema": {
            "title": "Desktop background wallpaper",
            "description": "The path to the image to be set as the new desktop wallpaper.",
            "type": "object",
            "properties": {
              "path": {
                "type": "string"
              },
              "value": {
                "type": "string",
                "default": "%SystemRoot%\\Web\\Wallpaper\\Windows\\img0.jpg"
              }
            }
          },
          "key": "ImageConfig"
        }
      }
    }
  }
}
