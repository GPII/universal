{
  "name": "Windows Built-in Narrator",
  "parents": ["gpii.solutionsRegistry.solution", "gpii.solutionsRegistry.context.windows"],
  "capabilities": [
    "http://registry\\.gpii\\.net/common/screenReaderTTS/enabled"
  ],
  "launchHandlers": {
    "launcher": {
      "type": "gpii.windows.enableRegisteredAT",
      "options": {
        "registryName": "Narrator",
        "getState": [
          {
            "type": "gpii.processReporter.find",
            "command": "Narrator.exe"
          }
        ]
      }
    }
  },
  "isInstalled": [
    {
      "type": "gpii.deviceReporter.alwaysInstalled"
    }
  ],
  "settingsHandlers": {
    "configure": {
      "liveness": "liveRestart",
      "capabilitiesTransformations": {
        "SpeechSpeed": {
          "transform": {
            "type": "fluid.transforms.round",
            "input": {
              "transform": {
                "type": "fluid.transforms.quantize",
                "inputPath": "http://registry\\.gpii\\.net/common/speechRate",
                "ranges": [
                  {
                    "upperBound": 50,
                    "output": 0
                  },
                  {
                    "upperBound": 150,
                    "output": {
                      "transform": {
                        "type": "fluid.transforms.linearScale",
                        "inputPath": "http://registry\\.gpii\\.net/common/speechRate",
                        "factor": 0.1,
                        "offset": -5
                      }
                    }
                  },
                  {
                    "upperBound": 450,
                    "output": {
                      "transform": {
                        "type": "fluid.transforms.linearScale",
                        "inputPath": "http://registry\\.gpii\\.net/common/speechRate",
                        "factor": 0.033333333333,
                        "offset": -5
                      }
                    }
                  },
                  {
                    "output": 20
                  }
                ]
              }
            }
          }
        },
        "SpeechPitch": {
          "transform": {
            "type": "fluid.transforms.linearScale",
            "inputPath": "http://registry\\.gpii\\.net/common/pitch",
            "factor": 20,
            "offset": 0
          }
        },
        "transform": [
          {
            "type": "fluid.transforms.arrayToSetMembership",
            "inputPath": "http://registry\\.gpii\\.net/common/trackingTTS",
            "outputPath": "",
            "presentValue": 1,
            "missingValue": 0,
            "options": {
              "focus": "CoupleNarratorCursorKeyboard",
              "caret": "FollowInsertion",
              "mouse": "InteractionMouse"
            }
          }
        ],
        "EchoChars": {
          "transform": {
            "type": "fluid.transforms.condition",
            "false": 0,
            "true": 1,
            "conditionPath": "http://registry\\.gpii\\.net/common/keyEcho"
          }
        },
        "EchoWords": {
          "transform": {
            "type": "fluid.transforms.condition",
            "false": 0,
            "true": 1,
            "conditionPath": "http://registry\\.gpii\\.net/common/wordEcho"
          }
        },
        "ReadingWithIntent": {
          "transform": {
            "type": "fluid.transforms.condition",
            "false": 0,
            "true": 1
          }
        }
      },
      "inverseCapabilitiesTransformations": {
        "http://registry\\.gpii\\.net/common/speechRate": {
          "transform": {
            "type": "fluid.transforms.condition",
            "condition": {
              "transform": {
                "type": "fluid.transforms.binaryOp",
                "leftPath": "SpeechSpeed",
                "right": 10,
                "operator": "<"
              }
            },
            "true": {
              "transform": {
                "type": "fluid.transforms.linearScale",
                "inputPath": "SpeechSpeed",
                "factor": 10,
                "offset": 50
              }
            },
            "false": {
              "transform": {
                "type": "fluid.transforms.linearScale",
                "inputPath": "SpeechSpeed",
                "factor": 30,
                "offset": -150
              }
            }
          }
        },
        "http://registry\\.gpii\\.net/common/pitch": {
          "transform": {
            "type": "fluid.transforms.linearScale",
            "inputPath": "SpeechPitch",
            "factor": 0.05,
            "offset": 0
          }
        },
        "transform": [
          {
            "type": "fluid.transforms.setMembershipToArray",
            "inputPath": "",
            "outputPath": "http://registry\\.gpii\\.net/common/trackingTTS",
            "presentValue": 1,
            "missingValue": 0,
            "options": {
              "CoupleNarratorCursorKeyboard": "focus",
              "FollowInsertion": "caret",
              "InteractionMouse": "mouse"
            }
          }
        ],
        "http://registry\\.gpii\\.net/common/keyEcho": {
          "transform": {
            "type": "fluid.transforms.binaryOp",
            "leftPath": "EchoChars",
            "right": 0,
            "operator": "!=="
          }
        },
        "http://registry\\.gpii\\.net/common/wordEcho": {
          "transform": {
            "type": "fluid.transforms.binaryOp",
            "leftPath": "EchoWords",
            "right": 0,
            "operator": "!=="
          }
        }
      },
      "settingsHandlerOptions": {
        "hKey": "HKEY_CURRENT_USER",
        "path": "Software\\Microsoft\\Narrator",
        "dataTypes": {
          "SpeechSpeed": "REG_DWORD",
          "SpeechPitch": "REG_DWORD",
          "InteractionMouse": "REG_DWORD",
          "CoupleNarratorCursorKeyboard": "REG_DWORD",
          "FollowInsertion": "REG_DWORD",
          "EchoChars": "REG_DWORD",
          "EchoWords": "REG_DWORD",
          "IntonationPause": "REG_DWORD",
          "ReadHints": "REG_DWORD",
          "PlayAudioCues": "REG_DWORD",
          "NarratorCursorHighlight": "REG_DWORD",
          "FastKeyEntryEnabled": "REG_DWORD",
          "ReadingWithIntent": "REG_DWORD",
          "ErrorNotificationType": "REG_DWORD",
          "CoupleNarratorCursorMouse": "REG_DWORD",
          "LockNarratorKeys": "REG_DWORD"
        }
      },
      "settingsHandlerNamespace": "gpii.windows.registrySettingsHandler",
      "supportedSettings": {
        "CoupleNarratorCursorKeyboard": {
          "schema": {
            "title": "Couple Narrator Cursor Keyboard",
            "description": "Whether to couple the narrator cursor to the keyboard",
            "enum": [
              0,
              1
            ],
            "enumLabels": [
              "Off",
              "On"
            ]
          }
        },
        "CoupleNarratorCursorMouse": {
          "schema": {
            "title": "Narrator cursor follow the mouse",
            "description": "Have the narrator cursor follow the mouse.",
            "enum": [
              0,
              1
            ],
            "enumLabels": [
              "Off",
              "On"
            ]
          }
        },
        "EchoChars": {
          "schema": {
            "title": "Echo Characters",
            "description": "Whether to echo characters typed.",
            "enum": [
              0,
              1
            ],
            "enumLabels": [
              "Off",
              "On"
            ]
          }
        },
        "EchoWords": {
          "schema": {
            "title": "Echo Words",
            "description": "Whether to echo words typed.",
            "enum": [
              0,
              1
            ],
            "enumLabels": [
              "Off",
              "On"
            ]
          }
        },
        "ErrorNotificationType": {
          "schema": {
            "title": "Speak narrator errors",
            "description": "Narrator announces errors such as 'no next landmark' or 'no next item.'",
            "enum": [
              0,
              1
            ],
            "enumLabels": [
              "Off",
              "On"
            ]
          }
        },
        "FastKeyEntryEnabled": {
          "schema": {
            "title": "Touch keyboard keys activated on finger lift",
            "description": "Make key insertion work on finger lift on touch keyboards",
            "enum": [
              0,
              1
            ],
            "enumLabels": [
              "Off",
              "On"
            ]
          }
        },
        "FollowInsertion": {
          "schema": {
            "title": "Couple Narrator Cursor Keyboard",
            "description": "Whether to couple the narrator cursor to the keyboard.",
            "enum": [
              0,
              1
            ],
            "enumLabels": [
              "Off",
              "On"
            ]
          }
        },
        "InteractionMouse": {
          "schema": {
            "title": "Interaction Mouse",
            "description": "Whether to follow mouse interactions.",
            "enum": [
              0,
              1
            ],
            "enumLabels": [
              "Off",
              "On"
            ]
          }
        },
        "IntonationPause": {
          "schema": {
            "title": "Narrator intonation pauses",
            "description": "Enable intonation pauses for Narrator",
            "enum": [
              0,
              1
            ],
            "enumLabels": [
              "Off",
              "On"
            ]
          }
        },
        "LockNarratorKeys": {
          "schema": {
            "title": "Lock Narrator keys",
            "description": "Lock the Narrator key so you don't have to press it with each command.",
            "enum": [
              0,
              1
            ],
            "enumLabels": [
              "Off",
              "On"
            ]
          }
        },
        "NarratorCursorHighlight": {
          "schema": {
            "title": "Cursor Highlight",
            "description": "Enable cursor highlighting with a blue focus box",
            "enum": [
              0,
              1
            ],
            "enumLabels": [
              "Off",
              "On"
            ]
          }
        },
        "PlayAudioCues": {
          "schema": {
            "title": "Read audio cues",
            "description": "Enable sound playing when you do things like perform a Narrator command or when suggestions are available",
            "enum": [
              0,
              1
            ],
            "enumLabels": [
              "Off",
              "On"
            ]
          }
        },
        "ReadingWithIntent": {
          "schema": {
            "title": "Emphasize formatted text",
            "description": "Narrator’s voice will put more emphasis on formatted text.",
            "enum": [
              0,
              1
            ],
            "enumLabels": [
              "Off",
              "On"
            ]
          }
        },
        "ReadHints": {
          "schema": {
            "title": "Read hints for controls and buttons",
            "description": "Enable narrator announcing how to interact with items",
            "enum": [
              0,
              1
            ],
            "enumLabels": [
              "Off",
              "On"
            ]
          }
        },
        "SpeechSpeed": {
          "schema": {
            "title": "Speech Speed",
            "description": "The speed at which text is announced.",
            "type": "integer",
            "minimum": 0,
            "maximum": 20,
            "default": 10
          }
        },
        "SpeechPitch": {
          "schema": {
            "title": "Speech Pitch",
            "description": "The pitch at which text is announced.",
            "minimum": 0,
            "maximum": 20
          }
        }
      }
    },
    "configureNoRoam": {
      "liveness": "live",
      "capabilitiesTransformations": {
        "SpeechVolume": {
          "transform": {
            "type": "fluid.transforms.linearScale",
            "inputPath": "http://registry\\.gpii\\.net/common/volumeTTS",
            "factor": 100,
            "offset": 0
          }
        },
        "ShowKeyboardIntroduction": {
          "transform": {
            "type": "fluid.transforms.condition",
            "false": 0,
            "true": 1,
            "conditionPath": "http://registry\\.gpii\\.net/common/speakTutorialMessages"
          }
        },
        "ShowBrowserSelection": {
          "transform": {
            "type": "fluid.transforms.literalValue",
            "input": 0
          }
        },
        "ContextVerbosityLevel": "http://registry\\.gpii\\.net/applications/com\\.microsoft\\.windows\\.narrator.ControlContextVerbosity",
        "RenderContextBeforeElement": "http://registry\\.gpii\\.net/applications/com\\.microsoft\\.windows\\.narrator.ReadContextBeforeControls",
        "DuckAudio": "http://registry\\.gpii\\.net/applications/com\\.microsoft\\.windows\\.narrator.LowerAppsVolume",
        "WinEnterLaunchEnabled": "http://registry\\.gpii\\.net/applications/com\\.microsoft\\.windows\\.narrator.StartWithShortcut",
        "VerbosityLevel": "http://registry\\.gpii\\.net/applications/com\\.microsoft\\.windows\\.narrator.TextVerbosityLevel"
      },
      "inverseCapabilitiesTransformations": {
        "http://registry\\.gpii\\.net/applications/com\\.microsoft\\.windows\\.narrator.ControlContextVerbosity": "ContextVerbosityLevel",
        "http://registry\\.gpii\\.net/applications/com\\.microsoft\\.windows\\.narrator.ReadContextBeforeControls": "RenderContextBeforeElement",
        "http://registry\\.gpii\\.net/applications/com\\.microsoft\\.windows\\.narrator.LowerAppsVolume": "DuckAudio",
        "http://registry\\.gpii\\.net/applications/com\\.microsoft\\.windows\\.narrator.StartWithShortcut": "WinEnterLaunchEnabled",
        "http://registry\\.gpii\\.net/applications/com\\.microsoft\\.windows\\.narrator.TextVerbosityLevel": "VerbosityLevel"
      },
      "settingsHandlerOptions": {
        "hKey": "HKEY_CURRENT_USER",
        "path": "Software\\Microsoft\\Narrator\\NoRoam",
        "dataTypes": {
          "SpeechVolume": "REG_DWORD",
          "SpeechVoice": "REG_SZ",
          "ShowKeyboardIntroduction": "REG_DWORD",
          "ShowBrowserSelection": "REG_DWORD",
          "ContextVerbosityLevel": "REG_DWORD",
          "RenderContextBeforeElement": "REG_DWORD",
          "DuckAudio": "REG_DWORD",
          "WinEnterLaunchEnabled": "REG_DWORD",
          "VerbosityLevel": "REG_DWORD",
          "DetailedFeedback": "REG_DWORD"
        }
      },
      "settingsHandlerNamespace": "gpii.windows.registrySettingsHandler",
      "supportedSettings": {
        "SpeechVolume": {
          "schema": {
            "title": "Speech volume",
            "description": "Changes the Narrator voice volume",
            "type": "number",
            "minimum": 0.01,
            "maximum": 1
          }
        },
        "SpeechVoice": {
          "schema": {
            "title": "Speech voice",
            "description": "Select which voice is going to be used for Narrator",
            "default": "Microsoft David - English (United States)",
            "enum": [
              "Microsoft David - English (United States)",
              "Microsoft Zira - English (United States)",
              "Microsoft Mark - English (United States)",
              "Microsoft David Desktop",
              "Microsoft Zira Desktop"
            ],
            "enumLabels": [
              "Microsoft David - English (United States)",
              "Microsoft Zira - English (United States)",
              "Microsoft Mark - English (United States)",
              "Microsoft David Desktop",
              "Microsoft Zira Desktop"
            ]
          }
        },
        "ShowKeyboardIntroduction": {
          "schema": {
            "title": "Show Keyboard Introduction",
            "description": "Whether or not to show the keyboard introduction.",
            "enum": [
              true,
              false
            ],
            "enumLabels": [
              "On",
              "Off"
            ]
          }
        },
        "ShowBrowserSelection": {
          "schema": {
            "title": "Show Browser Selection",
            "description": "Whether or not to show the browser selection.",
            "enum": [
              true,
              false
            ],
            "enumLabels": [
              "On",
              "Off"
            ]
          }
        },
        "ContextVerbosityLevel": {
          "schema": {
            "title": "Context Verbosity Level",
            "description": "Changes the amount of contextual reading for controls and buttons",
            "default": 2,
            "enum": [
              0,
              1,
              2,
              3,
              4,
              5
            ],
            "enumLabels": [
              "No context reading",
              "Sounds only",
              "Immediate context",
              "Immediate context name and type",
              "Full context of new control",
              "Full context of both the old control and new control"
            ]
          }
        },
        "RenderContextBeforeElement": {
          "schema": {
            "title": "Contextual reading order",
            "description": "Choose whether you want to hear context before or after the current item",
            "default": 1,
            "enum": [
              0,
              1
            ],
            "enumLabels": [
              "Before",
              "After"
            ]
          }
        },
        "DuckAudio": {
          "schema": {
            "title": "Lower other sounds",
            "description": "Enable/Disable lowering other sounds while narrator is speaking",
            "type": "boolean",
            "default": true
          }
        },
        "WinEnterLaunchEnabled": {
          "schema": {
            "title": "Start with shortcut",
            "description": "Allow the shortcut key to start Narrator",
            "type": "boolean",
            "default": true
          }
        },
        "VerbosityLevel": {
          "schema": {
            "title": "Text verbosity level",
            "description": "Changes the level of detail Narrator provides about text.",
            "default": 1,
            "enum": [
              0,
              1,
              2,
              3,
              4,
              5
            ],
            "enumLabels": [
              "0 - Text Only",
              "1 - Headers and errors",
              "2 - Basic information",
              "3 - Other annotations",
              "4 - Extended formatting",
              "5 - Layout and animation info"
            ]
          }
        },
        "DetailedFeedback": {
          "schema": {
            "title": "Additional feedback",
            "description": "Use caps lock + E to send additional feedback",
            "enum": [
              0,
              1
            ],
            "enumLabels": [
              "Off",
              "On"
            ],
            "default": 1
          }
        }
      }
    },
    "configureSystemSettings": {
      "liveness": "live",
      "capabilities": [],
      "capabilitiesTransformations": {
        "SystemSettings_Accessibility_Narrator_IsAutoStartEnabled": {
          "value": "http://registry\\.gpii\\.net/applications/com\\.microsoft\\.windows\\.narrator.EnableAutoStart"
        },
        "SystemSettings_Accessibility_Narrator_IsAutoStartOnLogonDesktopEnabled": {
          "value": "http://registry\\.gpii\\.net/applications/com\\.microsoft\\.windows\\.narrator.EnableSystemAutoStart"
        }
      },
      "inverseCapabilitiesTransformations": {
        "http://registry\\.gpii\\.net/applications/com\\.microsoft\\.windows\\.narrator.EnableAutoStart": "SystemSettings_Accessibility_Narrator_IsAutoStartEnabled.value",
        "http://registry\\.gpii\\.net/applications/com\\.microsoft\\.windows\\.narrator.EnableSystemAutoStart": "SystemSettings_Accessibility_Narrator_IsAutoStartOnLogonDesktopEnabled.value"
      },
      "settingsHandlerOptions": {
        "Async": true,
        "CheckResult": true
      },
      "settingsHandlerNamespace": "gpii.windows.systemSettingsHandler",
      "supportedSettings": {
        "SystemSettings_Accessibility_Narrator_IsAutoStartEnabled": {
          "schema": {
            "title": "Auto Start Narrator",
            "description": "Start Narrator after sign-in.",
            "type": "object",
            "properties": {
              "value": {
                "enum": [
                  0,
                  1
                ],
                "enumLabels": [
                  "Off",
                  "On"
                ],
                "default": 0
              }
            }
          }
        },
        "SystemSettings_Accessibility_Narrator_IsAutoStartOnLogonDesktopEnabled": {
          "schema": {
            "title": "Auto Start Narrator for everyone",
            "description": "Start Narrator before sign-in.",
            "type": "object",
            "properties": {
              "value": {
                "enum": [
                  0,
                  1
                ],
                "enumLabels": [
                  "Off",
                  "On"
                ],
                "default": 0
              }
            }
          }
        }
      }
    }
  }
}
