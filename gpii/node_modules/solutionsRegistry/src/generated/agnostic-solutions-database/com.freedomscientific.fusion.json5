{
  "name": "Fusion",
  "contexts": {
    "OS": [
      {
        "windows": {
          "id": "win32",
          "version": ">=5.0"
        }
      }
    ]
  },
  "capabilities": [
    "http://registry\\.gpii\\.net/common/magnification/enabled"
  ],
  "launchHandlers": {
    "launcher": {
      "type": "gpii.launchHandlers.flexibleHandler",
      "options": {
        "verifySettings": true,
        "retryOptions": {
          "rewriteEvery": 0,
          "numRetries": 20
        },
        "getState": [
          {
            "type": "gpii.processReporter.find",
            "command": "Zt.exe"
          }
        ],
        "setTrue": [
          {
            "type": "gpii.launch.exec",
            "command": "\"${{registry}.HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\App Paths\\Fusion2020.exe\\}\""
          }
        ],
        "setFalse": [
          {
            "type": "gpii.windows.closeProcessByName",
            "filename": "Zt.exe"
          }
        ]
      }
    }
  },
  "isInstalled": [
    {
      "type": "gpii.deviceReporter.registryKeyExists",
      "hKey": "HKEY_LOCAL_MACHINE",
      "path": "Software\\Microsoft\\Windows\\CurrentVersion\\App Paths\\Fusion2020.exe",
      "subPath": "",
      "dataType": "REG_SZ"
    }
  ]
}
