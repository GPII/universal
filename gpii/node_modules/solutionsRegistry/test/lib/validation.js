/* eslint-env node */
"use strict";
var fluid = require("infusion");
var gpii  = fluid.registerNamespace("gpii");

fluid.registerNamespace("gpii.tests.universal.solutionsRegistry");

// A helper function to standardise the display of validation errors in this module's tests.
gpii.tests.universal.solutionsRegistry.validateSinglePayload = function (payload, schema, payloadLabel) {
    var validationResults = gpii.schema.validator.validate(payload, schema);
    if (!validationResults.isError && !validationResults.isValid) {
        var localisedErrors = gpii.schema.validator.localiseErrors(validationResults.errors, payload);

        fluid.each(localisedErrors, function (singleError) {
            fluid.log("Validation error in " + payloadLabel + ":");
            fluid.log("  - " + singleError.dataPath.join(".") + ": " + singleError.message);
        });
    }
    return validationResults.isValid && !validationResults.isError;
};
