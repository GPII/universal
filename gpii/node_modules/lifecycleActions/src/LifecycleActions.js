/*
 * Standard Lifecycle Actions Definitions
 *
 * Copyright 2012 Antranig Basman
 *
 * Licensed under the New BSD license. You may not use this file except in
 * compliance with this License.
 *
 * The research leading to these results has received funding from the European Union's
 * Seventh Framework Programme (FP7/2007-2013)
 * under grant agreement no. 289016.
 *
 * You may obtain a copy of the License at
 * https://github.com/GPII/universal/blob/master/LICENSE.txt
 */

"use strict";

var fluid = require("infusion"),
    child_process = require("child_process"),
    fs = require("fs"),
    gpii = fluid.registerNamespace("gpii");

fluid.registerNamespace("gpii.launch");
fluid.registerNamespace("gpii.lifecycleActions");


fluid.defaults("gpii.launch.exec", {
    gradeNames: "fluid.function",
    argumentMap: {
        command: 0,
        options: 1
    }
});

gpii.launch.exec = child_process.exec;

fluid.defaults("gpii.launch.spawn", {
    gradeNames: "fluid.function",
    argumentMap: {
        command: 0,
        args: 1,
        options: 2
    }
});

gpii.launch.spawn = child_process.spawn;

fluid.defaults("gpii.lifecycleActions.pathExists", {
    gradeNames: "fluid.function",
    argumentMap: {
        path: 0
    }
});

gpii.lifecycleActions.pathExists = function (path) {
    if (!path) {
        fluid.fail("No path was given as option to gpii.lifecycleActions.pathExists");
    }
    return fs.existsSync(path);
};

fluid.defaults("gpii.lifecycleActions.createFile", {
    gradeNames: "fluid.function",
    argumentMap: {
        options: 0
    }
});

gpii.lifecycleActions.createFile = function (options) {
    if (!options.filename) {
        fluid.fail("No filename was given as option to gpii.lifecycleActions.createFile");
    }
    var content = options.content || "";
    fs.writeFileSync(options.filename, content);
};


