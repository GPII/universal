/**
 GPII Lifecycle Manager POST Handler

 Copyright 2013 OCAD University

 Licensed under the New BSD license. You may not use this file except in
 compliance with this License.

 You may obtain a copy of the License at
 https://github.com/gpii/universal/LICENSE.txt
*/

(function () {

    "use strict";

    var fluid = require("infusion"),
        gpii = fluid.registerNamespace("gpii"),
        kettle = fluid.require("kettle", require);

    kettle.requests.request.handler.lifecycleManagerStart = function (requestProxy, token, start, match) {
        start({
            userToken: token
        }, match, function (response) {
            fluid.log("Lifecycle manager returned: ", response);
            requestProxy.events.onSuccess.fire("User with token " + token +
                " was successfully logged in.");
        });
    };

    kettle.requests.request.handler.lifecycleManagerStop = function (requestProxy, token, stop) {
        stop({
            userToken: token
        }, function (response) {
            fluid.log("Lifecycle manager returned: ", response);
            requestProxy.events.onSuccess.fire("User with token " + token +
                " was successfully logged out.");
        });
    };

})();
